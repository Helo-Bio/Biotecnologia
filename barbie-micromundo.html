<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="theme-color" content="#ff69b4">

  <!-- Favicon (Logo na Aba) - Atualizado para 1-9652afda.ico -->
  <link rel="icon" href="img/1-9652afda.ico" type="image/x-icon">
  <link rel="shortcut icon" href="img/1-9652afda.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="imagens/icon-192.png">
  <!-- Fim das tags de Favicon -->

  <title>Barbie no Micromundo — Jogo Mobile Educativo</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#ffeef8;
      --card:#fff;
      --accent:#ff69b4;
      --muted:#ffb6da;
      --text:#3a1f3a;
      --correct-border:#4CAF50;
      --correct-bg:#e8f5e9;
      --wrong-border:#F44336;
      --wrong-bg:#ffebee;
      --spacing-sm: 8px;
      --spacing-md: 16px;
      --spacing-lg: 20px;
    }
    *{box-sizing:border-box;font-family:'Inter', system-ui, Arial, sans-serif; -webkit-tap-highlight-color: transparent;}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#fff);color:var(--text);display:flex;flex-direction:column;min-height:100vh;padding:var(--spacing-sm);font-size:1rem;}
    .app{width:100%;max-width:100%;background:var(--card);border-radius:12px;box-shadow:0 8px 24px rgba(250,105,176,0.15);overflow:hidden;}
    header{display:flex;flex-wrap:wrap;align-items:center;gap:var(--spacing-md);padding:var(--spacing-lg);background:linear-gradient(90deg,var(--accent),#ffd1ea);color:white;position:relative;}
    header::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-image:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="rgba(255,255,255,0.3)"/><circle cx="80" cy="40" r="1" fill="rgba(255,255,255,0.2)"/><circle cx="50" cy="80" r="1.5" fill="rgba(255,255,255,0.3)"/></svg>');background-size:cover;opacity:0.1;}
    header h1{margin:0;flex:1;font-size:1.5rem;font-weight:700;}
    .main{display:grid;grid-template-columns:1fr;gap:var(--spacing-md);padding:var(--spacing-lg);}
    .panel{background:linear-gradient(180deg,#fff,#fff0);border-radius:10px;padding:var(--spacing-md);min-height:200px;box-shadow:0 2px 8px rgba(0,0,0,0.05);overflow-y:auto;}
    .sidebar .mission{background:var(--bg);padding:var(--spacing-md);border-radius:8px;margin-bottom:var(--spacing-sm);font-size:0.9rem;cursor:pointer;transition:opacity 0.3s ease, background-color 0.3s ease; min-height:48px; display:flex;align-items:center;}
    .sidebar .mission.locked{opacity:0.5;cursor:not-allowed;}
    .sidebar .mission.active{background-color: var(--muted);}
    .sidebar .mission.completed{background-color: var(--correct-bg); border: 1px solid var(--correct-border); opacity: 0.8;}
    .barbie-evolution{text-align:center;margin-top:var(--spacing-md);}
    .barbie-img{max-width:100%;height:100px;border-radius:10px;box-shadow:0 4px 12px rgba(255,105,176,0.2);transition:opacity 0.5s ease; object-fit:cover;}
    .barbie-img.fade-in{opacity:1;}
    .barbie-img.fade-out{opacity:0;}
    .btn{display:block;width:100%;padding:var(--spacing-md);border-radius:10px;background:var(--accent);color:white;text-decoration:none;cursor:pointer;border:none;font-weight:600;transition:background-color 0.2s ease; min-height:48px; font-size:1rem;}
    .btn:hover:not(:disabled), .btn:active:not(:disabled){background-color:#e05a9e;}
    .btn:disabled{opacity:0.6;cursor:not-allowed;}
    .small{font-size:0.85rem;color:#6b465f}
    .question{font-weight:600;margin-bottom:var(--spacing-md);font-size:1.1rem;}
    .question-image{max-width:100%;height:auto;border-radius:8px;margin-bottom:var(--spacing-md);box-shadow:0 2px 8px rgba(0,0,0,0.1);transition:opacity 0.3s ease; display:block;}
    .answers{display:flex;flex-direction:column;gap:var(--spacing-sm)}
    .answer{padding:var(--spacing-lg);border-radius:10px;border:1px solid var(--muted);background:white;cursor:pointer;transition:background-color 0.2s ease, border-color 0.2s ease; min-height:50px; display:flex;align-items:center; word-break:break-word;}
    .answer:hover, .answer:active{background-color:#fdf0f6;}
    .answer.selected{border-color:var(--accent);background-color:#fff5fa;}
    .answer.correct{border-color:var(--correct-border);background-color:var(--correct-bg);font-weight:600;}
    .answer.wrong{border-color:var(--wrong-border);background-color:var(--wrong-bg);font-weight:600;}
    .feedback-message{margin-top:var(--spacing-md);padding:var(--spacing-md);border-radius:8px;font-size:0.9rem;line-height:1.5; word-break:break-word;}
    .feedback-correct{background-color:var(--correct-bg);color:var(--correct-border);border:1px solid var(--correct-border);}
    .feedback-wrong{background-color:var(--wrong-bg);color:var(--wrong-border);border:1px solid var(--wrong-border);}
    footer{padding:var(--spacing-md);text-align:center;color:#6b465f;font-size:0.8rem;}
    .score{font-weight:700;color:var(--accent);font-size:1rem;}
    .hidden{display:none;}
    .log-entry{margin-bottom:var(--spacing-sm);padding:var(--spacing-sm) 0;border-bottom:1px dotted #f0f0f0; font-size:0.85rem;}
    .progress-bar{background:var(--muted);height:8px;border-radius:4px;margin:var(--spacing-sm) 0;overflow:hidden;}
    .progress-fill{background:var(--accent);height:100%;transition:width 0.3s ease;border-radius:4px;}
    .hint-btn{margin:var(--spacing-sm) 0;padding:var(--spacing-md);font-size:0.9rem;background:#4CAF50;color:white;border:none;border-radius:8px;cursor:pointer; min-height:48px; width:100%;}
    .hint-btn:disabled{opacity:0.5;cursor:not-allowed;}
    /* Desktop: Grid lateral */
    @media (min-width: 769px){
      body{padding:var(--spacing-lg);}
      .app{width:980px;max-width:100%;}
      .main{grid-template-columns:360px 1fr;gap:var(--spacing-lg);}
      .btn{width:auto; display:inline-block; padding:var(--spacing-md) var(--spacing-lg);}
      .hint-btn{width:auto; margin-left:var(--spacing-md); margin:var(--spacing-sm) 0;}
      .answer{padding:var(--spacing-md); min-height:auto;}
      header{flex-wrap:nowrap;}
      .barbie-img{height:120px;}
      header h1{font-size:1.8rem;}
    }
    /* Tablet Landscape */
    @media (min-width: 481px) and (max-width: 768px) and (orientation: landscape){
      .main{grid-template-columns:300px 1fr;}
      .sidebar .mission{min-height:40px;}
    }
    /* Mobile Portrait */
    @media (max-width: 480px){
      body{font-size:0.95rem; padding:var(--spacing-sm);}
      header{padding:var(--spacing-md); flex-direction:column; text-align:center; gap:var(--spacing-sm);}
      header h1{font-size:1.3rem;}
      .panel{padding:var(--spacing-md); margin-bottom:var(--spacing-sm);}
      .barbie-img{height:80px;}
      .question{font-size:1rem;}
      .answer{padding:var(--spacing-lg 1.2rem); min-height:55px;}
      .btn, .hint-btn{padding:var(--spacing-lg); font-size:0.95rem;}
      footer{padding:var(--spacing-sm); font-size:0.75rem;}
      .sidebar .mission{padding:var(--spacing-md); font-size:0.85rem; min-height:50px;}
    }
    /* Evita zoom em double-tap em elementos interativos */
    .answer, .btn, .hint-btn { touch-action: manipulation; }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <!-- Caminho da imagem da Barbie no header corrigido para 'img/' -->
      <img id="headerBarbie" src="img/4d18359d57d625cdbe730f442d5061da.jpg" alt="Barbie Cientista Iniciante" style="width:70px;height:70px;border-radius:10px;background:rgba(255,255,255,0.15);object-fit:cover;transition:opacity 0.5s ease;">
      <div>
        <h1>Barbie no Micromundo</h1>
        <div class="small">Explore o micromundo no seu celular!</div>
      </div>
    </header>

    <div class="main">
      <div class="sidebar">
        <div class="panel">
          <h3>Missões (Progresso: <span id="progressCount">0</span>/15)</h3>
          <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width:0%;"></div></div>
          <div class="mission" id="m1">1. Reino dos Fungos</div>
          <div class="mission locked" id="m2">2. Microscópio Encantado</div>
          <div class="mission locked" id="m3">3. Micromundo</div>
          <div class="mission locked" id="m4">4. Caçadora de Micróbios</div>
          <div class="mission locked" id="m5">5. Laboratório Encantado</div>
          <div class="mission locked" id="m6">6. Fungos do Bem e do Mal</div>
          <div class="mission locked" id="m7">7. Energia do Micromundo</div>
          <div class="mission locked" id="m8">8. A Célula Secreta</div>
          <div class="mission locked" id="m9">9. O Grande Desafio Viral</div>
          <div class="mission locked" id="m10">10. Microbiologia Essencial</div>
          <div class="mission locked" id="m11">11. Morfologia Bacteriana</div>
          <div class="mission locked" id="m12">12. Gram Positivas vs. Negativas</div>
          <div class="mission locked" id="m13">13. Estrutura Bacteriana</div>
          <div class="mission locked" id="m14">14. Higiene e Sanitização</div>
          <div class="mission locked" id="m15">15. Doenças Bacterianas</div>

          <div style="margin-top:var(--spacing-md)">
            <button class="btn" id="startBtn">Começar Missão 1</button>
          </div>

          <div style="margin-top:var(--spacing-md);font-size:0.9rem">
            Pontuação: <span class="score" id="score">0</span><br>
            Cristais: <span id="cristais">0</span> • Lentes: <span id="lentes">0</span>
          </div>
        </div>

        

        <div class="panel" style="margin-top:12px">
          <h4>Evolução da Cientista Barbie</h4>
          <div class="barbie-evolution">
            <!-- Caminho da imagem da Barbie na sidebar corrigido para 'img/' -->
            <img id="sidebarBarbie" class="barbie-img fade-in" src="img/Barbie_Quimica_Base_Jaleco_Branco.png" alt="Barbie Iniciante">
            <p class="small" id="barbieStatus">Nível Iniciante: Pronta para explorar!</p>
          </div>
        </div>

        <div class="panel" style="margin-top:12px">
          <h4>Instruções Rápidas</h4>
          <ol style="padding-left:18px;margin:8px 0">
            <li>Responda as perguntas e colete recompensas.</li>
            <li>Cada acerto = +10 pontos. Use cristais para dicas!</li>
            <li>Evolua a Barbie completando missões (nova roupa a cada 3!)</li>
            <li>Complete as 15 missões para o grande final.</li>
          </ol>
        </div>
      </div>

      <div class="content">
        <div class="panel" id="gameArea">
          <div id="intro">
            <h2>Bem-vinda, Cientista Barbie!</h2>
            <p class="small">As margaridas estão em perigo! Evolua sua aparência e conhecimentos para salvá-las. Comece a jornada!</p>
          </div>

          <div id="questionArea" class="hidden">
            <div id="missionTitle" style="display:flex;justify-content:space-between;align-items:center">
              <h3></h3>
              <div class="small">Missão: <span id="missNum">1</span></div>
            </div>

            <div style="margin-top:10px">
              <img id="questionImage" class="question-image hidden" src="" alt="Imagem da Pergunta">
              <div class="question" id="qtext">Pergunta</div>
              <div class="answers" id="answers"></div>
            </div>

            <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
              <button class="btn" id="nextBtn">Próxima Pergunta</button>
              <button class="hint-btn" id="hintBtn" disabled>Dica (1 Cristal)</button>
              <div class="small">Erros permitidos por missão: <span id="errorCount">0</span>/3</div>
            </div>

            <div class="feedback-message hidden" id="feedback"></div>
          </div>

          <div id="endArea" class="hidden">
            <h2>Concluído!</h2>
            <p class="small" id="endText"></p>
            <button class="btn" id="restartBtn">Reiniciar Jogo</button>
          </div>
        </div>

        <div class="panel" style="margin-top:12px">
          <h4>Registro de Descobertas</h4>
          <div id="log" style="font-size:13px;color:#6b465f;max-height:200px;overflow-y:auto;"></div>
        </div>
      </div>
    </div>

    <footer>Protótipo criado com conceitos de <span style="font-weight:700">fungos, microscopia e microbiologia</span>.
    </footer>
  </div>

  <script>
   const missions = [
  {
    id:1, title:'Reino dos Fungos', reward:'💎 Cristais de Quitina',
    qs:[
      {q:'Qual é o principal polímero da parede celular dos fungos?', a:['Celulose','Quitina','Peptidoglicano','Quitossoma'], correct:1, explain:'Fungos têm parede celular de quitina.', image:'img/polimeros_fungos_muito_simples_portugues.jpg'},
      {q:'Qual fungo é usado para produzir penicilina?', a:['Aspergillus','Penicillium notatum','Saccharomyces','Amanita'], correct:1, explain:'Penicillium notatum produz penicilina.', image:'img/morfologia_penicilina_detalhada.jpg'},
      {q:'Candida albicans pode apresentar qual dimorfismo?', a:['Somente levedura','Levedura/filamentoso','Somente filamentos','Sem alteração'], correct:1, explain:'Candida é dimórfica: levedura em 37°C e bolor em 25°C.', image:'img/candida_albicans_morfologia.jpg'}
    ]
  },
  {
    id:2, title:'Microscópio Encantado', reward:'🔬 Lentes Mágicas',
    qs:[
      {q:'Qual ajuste usamos para focagem grosseira?', a:['Micrométrico','Macrométrico','Diafragma','Condensador'], correct:1, explain:'Ajuste macrométrico faz a focagem inicial.', image:'img/microscopio_macro.png'},
      {q:'Para usar objetiva de imersão, o que é necessário?', a:['Água','Óleo de cedro','Álcool 70%','Glicerol'], correct:1, explain:'Usa-se óleo de cedro para objetiva de imersão.', image:'img/oleoDeCedro.webp'},
      {q:'O que regula a intensidade luminosa no campo?', a:['Condensador','Revólver','Diafragma Iris','Platina'], correct:2, explain:'O Diafragma de Iris regula a intensidade.', image:'img/microscopio.webp'}
    ]
  },
  {
    id:3, title:'Micromundo', reward:'✨ Pó de Micélio',
    qs:[
      {q:'Leveduras são geralmente:', a:['Unicelulares','Pluricelulares','Procariontes','Autótrofas'], correct:0, explain:'Leveduras são unicelulares.', image:'img/Comparacao_Especies_Leveduras.jpg'},
      {q:'Fungos são, em geral, autótrofos ou heterótrofos?', a:['Autótrofos','Heterótrofos','Mixotrofos','Quimioautótrofos'], correct:1, explain:'Fungos são heterótrofos.', image:'img/Estruturas_Reprodutivas_Fungos_PT.jpg'},
      {q:'Qual grupo realiza fotossíntese?', a:['Fungos','Algas','Leveduras','Protozoários'], correct:1, explain:'Algas fotossintetizam.', image:'img/algas.jpg'}
    ]
  },
  {
    id:4, title:'Caçadora de Micróbios', reward:'📚 Livros de Taxonomia',
    qs:[
      {q:'As algas unicelulares pertencem a qual reino?', a:['Fungi','Monera','Protista','Animalia'], correct:2, explain:'Algas unicelulares estão no Reino Protista.', image:'img/reinos.png'},
      {q:'As arqueobactérias são procariontes ou eucariontes?', a:['Procariontes','Eucariontes','Nenhum','Ambos'], correct:0, explain:'Arqueobactérias são procariontes.', image:'img/Tipos_Morfologicos_Arqueobacterias.jpg'},
      {q:'Cogumelos pertencem a qual reino?', a:['Plantae','Fungi','Protista','Monera'], correct:1, explain:'Cogumelos fazem parte do Reino Fungi.', image:'img/ChatGPT Image 28 de set. de 2025, 19_21_09.png'}
    ]
  },
  {
    id:5, title:'Laboratório Encantado', reward:'🔧 Ferramentas de Microscopia',
    qs:[
      {q:'Qual parte do microscópio segura a lâmina?', a:['Platina','Condensador','Base','Revólver'], correct:0, explain:'A platina mantém a lâmina fixa para observação.', image:'img/microscopio_macro.png'},
      {q:'Qual o nome do ajuste fino de foco?', a:['Macrométrico','Micrométrico','Iris','Charriot'], correct:1, explain:'O ajuste micrométrico faz a focalização fina.', image:'img/microscopio_macro.png'},
      {q:'Qual a função do condensador?', a:['Aumentar a imagem','Concentrar a luz','Segurar a ocular','Girar as objetivas'], correct:1, explain:'O condensador concentra/distribui a luz no campo visual.', image:'img/microscopio_macro.png'}
    ]
  },
  {
    id:6, title:'Fungos do Bem e do Mal', reward:'🍄 Medalhas Micóticas',
    qs:[
      {q:'O Shimeji é um fungo...', a:['Comestível','Patogênico','Venenoso','Nenhum'], correct:0, explain:'O Shimeji é comestível.', image:'img/shimeji.webp'},
      {q:'A Amanita phalloides é...', a:['Comestível','Venenosa','Medicinal','Fermentadora'], correct:1, explain:'Amanita phalloides é venenosa.', image:'img/Amanita phalloides.webp'},
      {q:'O fungo usado para fermentar pão e cerveja é...', a:['Penicillium','Candida','Saccharomyces cerevisiae','Aspergillus'], correct:2, explain:'Saccharomyces cerevisiae realiza fermentação alcoólica.', image:'img/Saccharomyces_cerevisiae_SEM.jpg'}
    ]
  },
  {
    id:7, title:'Energia do Micromundo', reward:'⚡ Energia Mágica',
    qs:[
      {q:'Autótrofos fotossintetizantes usam...', a:['Matéria orgânica pronta','Luz solar, água e CO₂','Somente calor','Proteínas de outros organismos'], correct:1, explain:'Fotossintetizantes usam luz, água e CO₂.', image:'img/fotossintese.jpg'},
      {q:'Heterótrofos dependem de...', a:['Produzir seu alimento','Matéria orgânica de outros seres','Somente CO₂','Clorofila'], correct:1, explain:'Heterótrofos consomem matéria orgânica de outros organismos.', image:'img/heterotrofos.jpg'},
      {q:'A fermentação é um metabolismo...', a:['Aeróbico','Anaeróbico','Fotossintético','Quimiossintético'], correct:1, explain:'Fermentação é um processo anaeróbico.', image:'img/fermentacao.jpg'}
    ]
  },
  {
    id:8, title:'A Célula Secreta', reward:'🧬 Códigos Genéticos',
    qs:[
      {q:'Diferença principal procarionte vs eucarionte?', a:['Parede celular','Tamanho','Núcleo delimitado por membrana','Reprodução'], correct:2, explain:'Eucariontes têm núcleo e organelas; procariontes não.', image:'img/procarionte_eucarionte.jpg'},
      {q:'Bactérias e arqueias são?', a:['Eucariontes (complexas)','Procariontes (simples)','Multicelulares','Autótrofas obrigatórias'], correct:1, explain:'Procariontes têm DNA circular.', image:'img/bacterias_arqueias.jpg'},
      {q:'Células de fungos/animais são?', a:['Procariontes','Eucariontes (com organelas)','Acelulares','Unicelulares sempre'], correct:1, explain:'Eucariontes têm núcleo e mitocôndrias.', image: 'img/ChatGPT Image 28 de set. de 2025, 19_35_34.png'}
    ]
  },
  {
    id:9, title:'O Grande Desafio Viral', reward:'🦠 Antivírus Mágico',
    qs:[
      {q:'Por que vírus não são considerados seres vivos?', a:['São muito pequenos','Não possuem genoma','Acelulares e dependem de hospedeiros','Não causam doenças'], correct:2, explain:'Vírus são acelulares e só se replicam dentro de células hospedeiras.', image:'img/virus_ser_vivo.jpg'},
      {q:'Vírus possuem qual material genético?', a:['Somente DNA','Somente RNA','DNA ou RNA, nunca ambos','Não possuem material genético'], correct:2, explain:'Vírus podem ter DNA ou RNA, mas nunca os dois simultaneamente.', image:'img/virus_dna_rna.jpg'},
      {q:'Como vírus se replicam?', a:['Dividindo-se sozinhos','Usando células hospedeiras','Por fotossíntese','Por fermentação'], correct:1, explain:'Vírus utilizam células hospedeiras para replicar seu genoma.', image:'img/replicacao_viral.jpg'}
    ]
  },
  {
    id:10, title:'Microbiologia Essencial', reward:'🔬 Conhecimento Fundamental',
    qs:[
      {q:'O que a Microbiologia estuda?', a:['Apenas vírus','Apenas bactérias','Microrganismos, seres vivos microscópicos','Plantas e animais'], correct:2, explain:'A Microbiologia estuda microrganismos, seres vivos de dimensões microscópicas que não podem ser vistos a olho nu.', image:'img/microbiologia_estudo.jpg'},
      {q:'Qual a importância da Microbiologia para a Biotecnologia?', a:['Nenhuma','Fornece ferramentas para soluções inovadoras','Apenas para pesquisa básica','Somente para a indústria alimentícia'], correct:1, explain:'A Microbiologia fornece as ferramentas e o conhecimento essenciais para que a Biotecnologia crie soluções inovadoras para a saúde, o meio ambiente e a indústria.', image:'img/microbiologia_biotecnologia.jpg'},
      {q:'Defina bactérias.', a:['Organismos pluricelulares','Organismos vivos unicelulares','Vírus complexos','Células sem núcleo'], correct:1, explain:'Bactérias são organismos vivos unicelulares.', image:'img/bacterias_definicao.jpg'},
      {q:'O que são esporos bacterianos?', a:['Células reprodutivas','Um estado de resistência para sobreviver','Bactérias mortas','Fragmentos de DNA'], correct:1, explain:'Esporos bacterianos são um estado de resistência que algumas bactérias assumem para sobreviver.', image:'img/esporos_bacterianos.jpg'}
    ]
  },
  {
    id:11, title:'Morfologia Bacteriana', reward:'✨ Formas da Vida',
    qs:[
      {q:'Bactérias com formato redondo são classificadas como:', a:['Bacilos','Vibriões','Cocos','Espirilos'], correct:2, explain:'Cocos são bactérias redondas.', image:'img/bac_morfo.jpg'},
      {q:'Bactérias com formato em bastão são classificadas como:', a:['Cocos','Bacilos','Espiroquetas','Vibriões'], correct:1, explain:'Bacilos são bactérias em bastão.', image:'img/bac_morfo.jpg'},
      {q:'Qual a classificação para bactérias em forma de vírgula?', a:['Espirilos','Cocos','Vibriões','Bacilos'], correct:2, explain:'Vibriões são bactérias em forma de vírgula.', image:'img/bac_morfo.jpg'},
      {q:'Bactérias com espiral rígida são chamadas de:', a:['Espiroquetas','Cocos','Espirilos','Bacilos'], correct:2, explain:'Espirilos são bactérias com espiral rígida.', image:'img/bac_morfo.jpg'},
      {q:'Bactérias com espiral flexível são chamadas de:', a:['Bacilos','Espirilos','Espiroquetas','Vibriões'], correct:2, explain:'Espiroquetas são bactérias com espiral flexível.', image:'img/bac_morfo.jpg'}
    ]
  },
  {
    id:12, title:'Gram Positivas vs. Negativas', reward:'🌈 Cores da Coloração',
    qs:[
      {q:'Qual a principal característica da parede celular de bactérias Gram-positivas?', a:['Fina de lipopolissacarídeos','Espessa de peptidoglicano','Ausente','Com ácidos teicoicos e membrana externa'], correct:1, explain:'Gram-positivas possuem parede celular espessa de peptidoglicano.', image:'img/Estrutura_Parede_Celular_Gram_Positivas.jpg'},
      {q:'Bactérias Gram-negativas possuem membrana externa?', a:['Não, nunca','Sim, com lipopolissacarídeos (LPS)','Apenas em algumas espécies','Somente ácidos teicoicos'], correct:1, explain:'Gram-negativas têm membrana externa com lipopolissacarídeos (LPS).', image:'img/Estrutura_Parede_Celular_Gram_Negativas_Nova.jpg'},
      {q:'Qual a cor das bactérias Gram-positivas após a coloração de Gram?', a:['Rosa/Vermelha','Incolor','Roxa/Azul','Verde'], correct:2, explain:'Gram-positivas coram em roxo/azul.', image:'img/gram_positiva_cor.jpg'},
      {q:'Qual a cor das bactérias Gram-negativas após a coloração de Gram?', a:['Roxa/Azul','Verde','Rosa/Vermelha','Incolor'], correct:2, explain:'Gram-negativas coram em rosa/vermelha.', image:'img/gram_negativa_cor.jpg'},
      {q:'Qual tipo de bactéria é geralmente mais resistente a antibióticos?', a:['Gram-positivas','Gram-negativas','Ambas igualmente','Nenhuma'], correct:1, explain:'Gram-negativas são mais resistentes a antibióticos devido à sua membrana externa.', image:'img/resistencia_antibioticos.jpg'}
    ]
  },
  {
    id:13, title:'Estrutura Bacteriana', reward:'🔬 Componentes Celulares',
    qs:[
      {q:'Qual estrutura rígida dá forma e proteção à célula bacteriana?', a:['Membrana Plasmática','Cápsula','Parede Celular','Flagelo'], correct:2, explain:'A Parede Celular é uma estrutura rígida que dá forma e proteção à célula, composta por peptidoglicano.', image:'img/estrutura_bacteriana_parede.jpg'},
      {q:'Qual organela é responsável pela síntese de proteínas?', a:['Plasmídeo','Nucleoide','Ribossomos','Mesossomo'], correct:2, explain:'Os Ribossomos são responsáveis pela síntese de proteínas.', image:'img/estrutura_bacteriana_ribossomos.jpg'},
      {q:'Qual estrutura confere vantagens adaptativas, como resistência a antibióticos?', a:['Cápsula','Flagelo','Plasmídeo','Inclusões Citoplasmáticas'], correct:2, explain:'Plasmídeos são pequenas moléculas circulares de DNA extra que conferem vantagens adaptativas.', image:'img/estrutura_bacteriana_plasmideo.jpg'},
      {q:'Qual a função da Membrana Plasmática em bactérias?', a:['Armazenar reservas','Locomoção','Controlar entrada e saída de substâncias e funções metabólicas','Proteger contra o sistema imunológico'], correct:2, explain:'A Membrana Plasmática controla a entrada e saída de substâncias e é responsável por funções metabólicas como a respiração celular.', image:'img/estrutura_bacteriana_membrana.jpg'},
      {q:'Qual estrutura é responsável pela locomoção da bactéria?', a:['Cápsula','Flagelo','Pili','Parede Celular'], correct:1, explain:'O Flagelo é uma estrutura filamentosa longa responsável pela locomoção da bactéria.', image:'img/estrutura_bacteriana_flagelo.jpg'}
    ]
  },
  {
    id:14, title:'Higiene e Sanitização', reward:'🧼 Protocolos de Limpeza',
    qs:[
      {q:'Qual a finalidade da pré-lavagem na manipulação de alimentos?', a:['Aplicar sanitizante','Remover resíduos grandes','Eliminar detergente','Avaliar a higiene'], correct:1, explain:'A pré-lavagem serve para remover resíduos grandes.', image:'img/higiene_pre_lavagem.jpg'},
      {q:'Qual a finalidade da lavagem com detergente?', a:['Matar microrganismos','Remover sujeira aderida','Remover excesso de químico','Garantir a eficácia'], correct:1, explain:'A lavagem com detergente serve para tirar a sujeira aderida.', image:'img/higiene_lavagem.jpg'},
      {q:'Qual a finalidade da sanitização?', a:['Remover resíduos','Eliminar detergente','Matar/reduzir microrganismos','Apenas enxaguar'], correct:2, explain:'A sanitização serve para matar ou reduzir microrganismos.', image:'img/higiene_sanitizacao.jpg'},
      {q:'Por que é importante o enxágue após a aplicação do sanitizante?', a:['Para aplicar mais sanitizante','Para remover o excesso de químico','Para secar o equipamento','Para avaliar a limpeza'], correct:1, explain:'O enxágue após o sanitizante serve para remover o excesso de químico.', image:'img/higiene_enxague.jpg'},
      {q:'Qual a última etapa do programa de higiene e qual sua finalidade?', a:['Sanitização, para matar microrganismos','Lavagem, para tirar sujeira','Avaliação, para garantir a eficácia','Pré-lavagem, para remover resíduos'], correct:2, explain:'A avaliação é a última etapa para garantir a eficácia da higienização.', image:'img/higiene_avaliacao.jpg'}
    ]
  },
  {
    id:15, title:'Doenças Bacterianas', reward:'🛡️ Escudo Imunológico',
    qs:[
      {q:'Qual o agente causador da Cólera?', a:['Mycobacterium tuberculosis','Clostridium tetani','Vibrio cholerae','Escherichia coli'], correct:2, explain:'O agente causador da Cólera é o Vibrio cholerae.', image:'img/COLETRA.webp'},
      {q:'Quais são os sintomas da Tuberculose?', a:['Diarreia intensa e vômitos','Espasmos musculares e dificuldade para abrir a boca','Tosse persistente, febre, suores noturnos, perda de peso','Erupções cutâneas e dor de cabeça'], correct:2, explain:'Os sintomas da Tuberculose incluem tosse persistente, febre, suores noturnos e perda de peso.', image:'img/TUBERCULOSE.jpg'},
      {q:'Como o Tétano é transmitido?', a:['Pela ingestão de água contaminada','Pela via respiratória','Através de feridas contaminadas com esporos da bactéria','Pelo contato com animais infectados'], correct:2, explain:'O Tétano é transmitido através de feridas contaminadas com esporos da bactéria Clostridium tetani.', image:'img/TETANO.jpg'},
      {q:'Qual o tratamento para a Cólera?', a:['Antibióticos específicos por longo período','Antitoxina e antibióticos','Reidratação e antibióticos','Cirurgia'], correct:2, explain:'O tratamento para a Cólera envolve reidratação e antibióticos.', image:'img/colera_tratamento.jpg'},
      {q:'Qual o agente causador do Tétano?', a:['Vibrio cholerae','Mycobacterium tuberculosis','Clostridium tetani','Staphylococcus aureus'], correct:2, explain:'O agente causador do Tétano é o Clostridium tetani.', image:'img/tetano_agente.jpg'}
    ]
  }
];
    // ------------- LÓGICA DO JOGO -------------
    let currentMission = 0;
    let qIndex = 0;
    let score = 0;
    let cristais = 0;
    let lentes = 0;
    let errors = 0;
    let answerSelected = false;
    let completedMissions = 0;

    const startBtn = document.getElementById('startBtn');
    const questionArea = document.getElementById('questionArea');
    const intro = document.getElementById('intro');
    const qtext = document.getElementById('qtext');
    const answersEl = document.getElementById('answers');
    const missionTitle = document.querySelector('#missionTitle h3');
    const missNum = document.getElementById('missNum');
    const nextBtn = document.getElementById('nextBtn');
    const scoreEl = document.getElementById('score');
    const cristaisEl = document.getElementById('cristais');
    const lentesEl = document.getElementById('lentes');
    const feedback = document.getElementById('feedback');
    const log = document.getElementById('log');
    const endArea = document.getElementById('endArea');
    const endText = document.getElementById('endText');
    const restartBtn = document.getElementById('restartBtn');
    const progressCount = document.getElementById('progressCount');
    const progressFill = document.getElementById('progressFill');
    const errorCountEl = document.getElementById('errorCount');
    const hintBtn = document.getElementById('hintBtn');
    const questionImage = document.getElementById('questionImage');
    const sidebarBarbie = document.getElementById('sidebarBarbie');
    const headerBarbie = document.getElementById('headerBarbie');
    const barbieStatus = document.getElementById('barbieStatus');

    const barbieImages = [
      "img/4d18359d57d625cdbe730f442d5061da.jpg", // Iniciante
      "img/Barbie_Quimica_Jaleco_Azul.png", // Nível 1 (após 3 missões)
      "img/Barbie_Quimica_Jaleco_Rosa.png", // Nível 2 (após 6 missões)
      "img/Barbie_Quimica_Jaleco_Verde.png", // Nível 3 (após 9 missões)
      "img/Barbie_Quimica_Jaleco_Roxo.png", // Nível 4 (após 12 missões)
      "img/Barbie_Quimica_Traje_Protecao.png"  // Nível Final (após 15 missões)
    ];

    const barbieStatuses = [
      "Nível Iniciante: Pronta para explorar!",
      "Nível Aprendiz: Desvendando os segredos!",
      "Nível Pesquisadora: Em busca de novas descobertas!",
      "Nível Cientista: Dominando o micromundo!",
      "Nível Mestra: Conhecimento ilimitado!",
      "Nível Lendária: Salvadora do micromundo!"
    ];

    // Inicial: next desabilitado
    nextBtn.disabled = true;
    hintBtn.disabled = true;

    // startBtn agora é dinâmico: usa dataset.next quando presente
    startBtn.addEventListener('click', ()=>{
      const next = startBtn.dataset.next;
      if(next){
        startMission(parseInt(next,10));
      } else {
        startMission(1);
      }
    });

    nextBtn.addEventListener('click', ()=>{
      nextQuestion();
    });
    restartBtn.addEventListener('click', ()=>{ location.reload(); });
    hintBtn.addEventListener('click', useHint);

    function updateProgressBar() {
      progressCount.textContent = completedMissions;
      const percentage = (completedMissions / missions.length) * 100;
      progressFill.style.width = `${percentage}%`;
    }

    function updateBarbieEvolution() {
      const level = Math.floor(completedMissions / 3); // Nova roupa a cada 3 missões
      const imageIndex = Math.min(level, barbieImages.length - 1);
      const statusIndex = Math.min(level, barbieStatuses.length - 1);

      sidebarBarbie.classList.add('fade-out');
      headerBarbie.classList.add('fade-out');

      setTimeout(() => {
        sidebarBarbie.src = barbieImages[imageIndex];
        headerBarbie.src = barbieImages[imageIndex];
        barbieStatus.textContent = barbieStatuses[statusIndex];
        sidebarBarbie.classList.remove('fade-out');
        headerBarbie.classList.remove('fade-out');
        sidebarBarbie.classList.add('fade-in');
        headerBarbie.classList.add('fade-in');
      }, 500); // Tempo para a transição de fade
    }

    function setupMissionSelection() {
      document.querySelectorAll('.mission').forEach((m, index) => {
        m.removeEventListener('click', handleMissionClick); // Remove listeners antigos para evitar duplicação
        if (index <= completedMissions) { // Desbloqueia missões já completadas e a próxima a ser jogada
          m.classList.remove('locked');
          m.addEventListener('click', handleMissionClick);
        } else {
          m.classList.add('locked');
        }
        m.classList.remove('active');
      });
    }

    function handleMissionClick(event) {
      const missionId = parseInt(event.target.id.replace('m', ''), 10);
      if (!event.target.classList.contains('locked')) {
        startMission(missionId);
      }
    }

    function startMission(n){
      // n é 1-based
      currentMission = n-1;
      qIndex = 0;
      errors = 0;
      errorCountEl.textContent = errors;
      answerSelected = false;
      intro.classList.add('hidden');
      endArea.classList.add('hidden');
      questionArea.classList.remove('hidden');
      missionTitle.textContent = missions[currentMission].title;
      missNum.textContent = missions[currentMission].id;
      
      setupMissionSelection(); // Atualiza o estado de bloqueio/desbloqueio e listeners
      const currentMissionEl = document.getElementById('m'+(currentMission+1));
      if(currentMissionEl) currentMissionEl.classList.add('active');
      
      startBtn.style.display = 'none';
      logEntry('Iniciada missão: '+missions[currentMission].title);
      showQuestion();
    }

    function showQuestion(){
      const q = missions[currentMission].qs[qIndex];
      qtext.textContent = q.q;
      answersEl.innerHTML = '';
      answerSelected = false;
      nextBtn.disabled = true;
      feedback.textContent = '';
      feedback.className = 'feedback-message hidden'; // Reset feedback style
      hintBtn.disabled = (cristais === 0); // Habilita dica se tiver cristais

      if (q.image) {
        questionImage.src = q.image;
        questionImage.classList.remove('hidden');
      } else {
        questionImage.classList.add('hidden');
        questionImage.src = ''; // Limpa a imagem
      }

      q.a.forEach((opt,i)=>{
        const btn = document.createElement('div');
        btn.className='answer';
        btn.textContent = opt;
        btn.addEventListener('click', ()=>selectAnswer(i,btn));
        answersEl.appendChild(btn);
      });
    }

    function selectAnswer(i,el){
      if (answerSelected) return; // Evita múltiplas seleções

      const q = missions[currentMission].qs[qIndex];
      const buttons = Array.from(document.querySelectorAll('.answer'));
      buttons.forEach(b=>b.style.pointerEvents='none'); // Desabilita cliques após seleção
      
      answerSelected = true;
      nextBtn.disabled = false;
      hintBtn.disabled = true; // Desabilita dica após seleção

      if(i===q.correct){
        el.classList.add('correct');
        score += 10; scoreEl.textContent = score;
        // rewards
        if(missions[currentMission].reward.includes('Cristais')) { cristais += 1; cristaisEl.textContent = cristais}
        if(missions[currentMission].reward.includes('Lentes')) { lentes += 1; lentesEl.textContent = lentes}
        feedback.textContent = 'Correto! '+q.explain;
        feedback.classList.remove('hidden');
        feedback.classList.add('feedback-correct');
        logEntry('Acertou: '+q.q);
      } else {
        el.classList.add('wrong');
        buttons[q.correct].classList.add('correct'); // Mostra a resposta correta
        errors += 1;
        errorCountEl.textContent = errors;
        feedback.textContent = 'Errado. '+q.explain;
        feedback.classList.remove('hidden');
        feedback.classList.add('feedback-wrong');
        logEntry('Errou: '+q.q);
      }
    }

    function useHint() {
      if (cristais > 0 && !answerSelected) {
        cristais--;
        cristaisEl.textContent = cristais;
        hintBtn.disabled = true; // Desabilita o botão de dica após o uso

        const q = missions[currentMission].qs[qIndex];
        const answers = Array.from(document.querySelectorAll('.answer'));
        
        // Remove uma resposta incorreta aleatoriamente
        let incorrectAnswers = answers.filter((ans, idx) => idx !== q.correct && ans.style.opacity !== '0.3');
        if (incorrectAnswers.length > 0) {
          const randomIndex = Math.floor(Math.random() * incorrectAnswers.length);
          incorrectAnswers[randomIndex].style.opacity = '0.3'; // Ou remova o elemento
          incorrectAnswers[randomIndex].style.pointerEvents = 'none';
        }
        logEntry('Usou uma dica na pergunta: '+q.q);
      }
    }

    function nextQuestion(){
      // evitar avançar sem resposta (fallback)
      if(!answerSelected){
        feedback.textContent = 'Selecione uma resposta antes de continuar.';
        feedback.classList.remove('hidden');
        feedback.classList.add('feedback-wrong'); // Pode ser um estilo neutro também
        return;
      }

      const mission = missions[currentMission];
      
      if(errors>=3){
        // mission failed
        logEntry('Missão falhada: '+mission.title);
        questionArea.classList.add('hidden');
        endArea.classList.remove('hidden');
        endText.textContent = 'Você cometeu muitos erros nesta missão. Barbie precisa de mais foco! Tente novamente para ajudar Barbie a salvar o micromundo.';
        startBtn.style.display = 'inline-block';
        startBtn.textContent = 'Tentar Novamente a Missão ' + (currentMission + 1);
        startBtn.dataset.next = (currentMission+1).toString(); // retry same mission (1-based)
        document.getElementById('m'+(currentMission+1)).classList.remove('active');
        return;
      }

      qIndex +=1;

      if(qIndex>=mission.qs.length){
        // mission complete
        score += 5; scoreEl.textContent = score; // bonus
        logEntry('Missão concluída: '+mission.title);
        document.getElementById('m'+(currentMission+1)).classList.add('completed');
        document.getElementById('m'+(currentMission+1)).classList.remove('active');
        completedMissions++;
        updateProgressBar();
        updateBarbieEvolution();

        questionArea.classList.add('hidden');
        endArea.classList.remove('hidden');
        
        if(currentMission < missions.length-1){
          endText.textContent = `Missão ${mission.id} concluída! Você ganhou ${mission.reward}. Clique em "Continuar" para iniciar a próxima missão.`;
          startBtn.style.display = 'inline-block';
          startBtn.textContent = 'Continuar para Missão ' + (currentMission + 2);
          startBtn.dataset.next = (currentMission+2).toString(); // next mission 1-based
          // Desbloqueia a próxima missão na sidebar
          const nextMissionEl = document.getElementById('m'+(currentMission+2));
          if (nextMissionEl) {
            nextMissionEl.classList.remove('locked');
            nextMissionEl.addEventListener('click', handleMissionClick);
          }
        } else {
          endText.textContent = 'Parabéns! Barbie salvou o micromundo e se tornou uma cientista lendária! Pontos totais: '+score+'. Cristais: '+cristais+'. Lentes: '+lentes;
          startBtn.style.display = 'inline-block'; // Corrigido para 'inline-block'
          startBtn.textContent = 'Jogar Novamente';
          startBtn.dataset.next = '1';
        }
        return;
      }
      showQuestion();
    }

    function logEntry(text){
      const time = new Date().toLocaleTimeString();
      log.innerHTML = `<div>[${time}] ${text}</div>`+log.innerHTML;
    }

    // Inicialização
    updateProgressBar();
    updateBarbieEvolution();
    setupMissionSelection(); // Configura a seleção de missões ao carregar a página
  </script>
  <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ff69b4">
</body>
</html>
